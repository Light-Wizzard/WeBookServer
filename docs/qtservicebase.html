<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- qtservice.cpp -->
  <title>QtServiceBase Class | WeBookServer.pro 5.15.0</title>
</head>
<body>
<li>QtServiceBase</li>
<div class="sidebar">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#protected-functions">Protected Functions</a></li>
<li class="level1"><a href="#details">Detailed Description</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">QtServiceBase Class</h1>
<!-- $$$QtServiceBase-brief -->
<p>The QtServiceBase class provides an API for implementing Windows services and Unix daemons. <a href="#details">More...</a></p>
<!-- @@@QtServiceBase -->
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> Header:</td><td class="memItemRight bottomAlign"> <span class="preprocessor">#include &lt;QtServiceBase&gt;</span>
</td></tr><tr><td class="memItemLeft rightAlign topAlign"> Inherited By:</td><td class="memItemRight bottomAlign"> <p><a href="qtservice.html">QtService</a></p>
</td></tr></table></div><ul>
<li><a href="qtservicebase-members.html">List of all members, including inherited members</a></li>
</ul>
<a name="protected-functions"></a>
<h2 id="protected-functions">Protected Functions</h2>
<div class="table"><table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#createApplication">createApplication</a></b>(int &amp;<i>argc</i>, char **<i>argv</i>) = 0</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual int </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#executeApplication">executeApplication</a></b>() = 0</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#pause">pause</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#processCommand">processCommand</a></b>(int <i>code</i>)</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#resume">resume</a></b>()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#start">start</a></b>() = 0</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual void </td><td class="memItemRight bottomAlign"><b><a href="qtservicebase.html#stop">stop</a></b>()</td></tr>
</table></div>
<a name="details"></a>
<!-- $$$QtServiceBase-description -->
<div class="descr">
<h2 id="details">Detailed Description</h2>
<p>A Windows service or Unix daemon (a &quot;service&quot;), is a program that runs &quot;in the background&quot; independently of whether a user is logged in or not. A service is often set up to start when the machine boots up, and will typically run continuously as long as the machine is on.</p>
<p>Services are usually non-interactive console applications. User interaction, if required, is usually implemented in a separate, normal GUI application that communicates with the service through an IPC channel. For simple communication, QtServiceController::sendCommand() and <a href="qtservicebase.html#processCommand">QtService::processCommand</a>() may be used, possibly in combination with a shared settings file. For more complex, interactive communication, a custom IPC channel should be used, e.g&#x2e; based on Qt's networking classes. (In certain circumstances, a service may provide a GUI itself, ref. the &quot;interactive&quot; example documentation).</p>
<p>Typically, you will create a service by subclassing the <a href="qtservice.html">QtService</a> template class which inherits QtServiceBase and allows you to create a service for a particular application type.</p>
<p>The Windows implementation uses the NT Service Control Manager, and the application can be controlled through the system administration tools. Services are usually launched using the system account, which requires that all DLLs that the service executable depends on (i.e&#x2e; Qt), are located in the same directory as the service, or in a system path.</p>
<p>On Unix a service is implemented as a daemon.</p>
<p>You can retrieve the service's description, state, and startup type using the serviceDescription(), serviceFlags() and startupType() functions respectively. The service's state is decribed by the ServiceFlag enum. The mentioned properites can also be set using the corresponding set functions. In addition you can retrieve the service's name using the serviceName() function.</p>
<p>Several of QtServiceBase's protected functions are called on requests from the <a href="qtservicecontroller.html">QtServiceController</a> class:</p>
<ul>
<li><a href="qtservicebase.html#start">start</a>()</li>
<li><a href="qtservicebase.html#pause">pause</a>()</li>
<li><a href="qtservicebase.html#processCommand">processCommand</a>()</li>
<li><a href="qtservicebase.html#resume">resume</a>()</li>
<li><a href="qtservicebase.html#stop">stop</a>()</li>
</ul>
<p>You can control any given service using an instance of the <a href="qtservicecontroller.html">QtServiceController</a> class which also allows you to control services from separate applications. The mentioned functions are all virtual and won't do anything unless they are reimplemented. You can reimplement these functions to pause and resume the service's execution, as well as process user commands and perform additional clean-ups before shutting down.</p>
<p>QtServiceBase also provides the static instance() function which returns a pointer to an application's QtServiceBase instance. In addition, a service can report events to the system's event log using the logMessage() function. The MessageType enum describes the different types of messages a service reports.</p>
<p>The implementation of a service application's main function typically creates an service object derived by subclassing the <a href="qtservice.html">QtService</a> template class. Then the main function will call this service's exec() function, and return the result of that call. For example:</p>
<pre class="cpp"><span class="type">int</span> main(<span class="type">int</span> argc<span class="operator">,</span> <span class="type">char</span> <span class="operator">*</span><span class="operator">*</span>argv)
{
    MyService service(argc<span class="operator">,</span> argv);
    <span class="keyword">return</span> service<span class="operator">.</span>exec();
}</pre>
<p>When the exec() function is called, it will parse the service specific arguments passed in <code>argv</code>, perform the required actions, and return.</p>
<p>arget serviceSpecificArguments</p>
<p>The following arguments are recognized as service specific:</p>
<p>able <i>Short</i> <i>Long</i> <i>Explanation</i> <i>-i</i> <i>-install</i> <i>Install</i> the service. <i>-u</i> <i>-uninstall</i> <i>Uninstall</i> the service. <i>-e</i> <i>-exec</i> <i>Execute</i> the service as a standalone application (useful for debug purposes). This is a blocking call, the service will be executed like a normal application. In this mode you will not be able to communicate with the service from the contoller. <i>-t</i> <i>-terminate</i> <i>Stop</i> the service. <i>-p</i> <i>-pause</i> <i>Pause</i> the service. <i>-r</i> <i>-resume</i> <i>Resume</i> a paused service. <i>-c</i> <i>cmd</i> <i>-command</i> <i>cmd</i> <i>Send</i> the user defined command code <i>cmd</i> to the service application. <i>-v</i> <i>-version</i> <i>Display</i> version and status information.</p>
<p>If <i>none</i> of the arguments is recognized as service specific, exec() will first call the <a href="qtservicebase.html#createApplication">createApplication</a>() function, then <a href="qtservicebase.html#executeApplication">executeApplication</a>() and finally the <a href="qtservicebase.html#start">start</a>() function. In the end, exec() returns while the service continues in its own process waiting for commands from the service controller.</p>
</div>
<p><b>See also </b><a href="qtservice.html">QtService</a> and <a href="qtservicecontroller.html">QtServiceController</a>.</p>
<!-- @@@QtServiceBase -->
<div class="func">
<h2>Member Function Documentation</h2>
<!-- $$$createApplication[overload1]$$$createApplicationint&char** -->
<h3 class="fn" id="createApplication"><a name="createApplication"></a><code>[pure virtual protected] </code><span class="type">void</span> QtServiceBase::<span class="name">createApplication</span>(<span class="type">int</span> &amp;<i>argc</i>, <span class="type">char</span> **<i>argv</i>)</h3>
<p>Creates the application object using the <i>argc</i> and <i>argv</i> parameters.</p>
<p>This function is only called when no service specific arguments were passed to the service constructor, and is called by exec() before it calls the <a href="qtservicebase.html#executeApplication">executeApplication</a>() and <a href="qtservicebase.html#start">start</a>() functions.</p>
<p>The createApplication() function is implemented in <a href="qtservice.html">QtService</a>, but you might want to reimplement it, for example, if the chosen application type's constructor needs additional arguments.</p>
<p><b>See also </b>exec() and <a href="qtservice.html">QtService</a>.</p>
<!-- @@@createApplication -->
<!-- $$$executeApplication[overload1]$$$executeApplication -->
<h3 class="fn" id="executeApplication"><a name="executeApplication"></a><code>[pure virtual protected] </code><span class="type">int</span> QtServiceBase::<span class="name">executeApplication</span>()</h3>
<p>Executes the application previously created with the <a href="qtservicebase.html#createApplication">createApplication</a>() function.</p>
<p>This function is only called when no service specific arguments were passed to the service constructor, and is called by exec() after it has called the <a href="qtservicebase.html#createApplication">createApplication</a>() function and before <a href="qtservicebase.html#start">start</a>() function.</p>
<p>This function is implemented in <a href="qtservice.html">QtService</a>.</p>
<p><b>See also </b>exec() and <a href="qtservicebase.html#createApplication">createApplication</a>().</p>
<!-- @@@executeApplication -->
<!-- $$$pause[overload1]$$$pause -->
<h3 class="fn" id="pause"><a name="pause"></a><code>[virtual protected] </code><span class="type">void</span> QtServiceBase::<span class="name">pause</span>()</h3>
<p>Reimplement this function to pause the service's execution (for example to stop a polling timer, or to ignore socket notifiers).</p>
<p>This function is called in reply to controller requests. The default implementation does nothing.</p>
<p><b>See also </b><a href="qtservicebase.html#resume">resume</a>() and QtServiceController::pause().</p>
<!-- @@@pause -->
<!-- $$$processCommand[overload1]$$$processCommandint -->
<h3 class="fn" id="processCommand"><a name="processCommand"></a><code>[virtual protected] </code><span class="type">void</span> QtServiceBase::<span class="name">processCommand</span>(<span class="type">int</span> <i>code</i>)</h3>
<p>Reimplement this function to process the user command <i>code</i>.</p>
<p>This function is called in reply to controller requests. The default implementation does nothing.</p>
<p><b>See also </b>QtServiceController::sendCommand().</p>
<!-- @@@processCommand -->
<!-- $$$resume[overload1]$$$resume -->
<h3 class="fn" id="resume"><a name="resume"></a><code>[virtual protected] </code><span class="type">void</span> QtServiceBase::<span class="name">resume</span>()</h3>
<p>Reimplement this function to continue the service after a call to <a href="qtservicebase.html#pause">pause</a>().</p>
<p>This function is called in reply to controller requests. The default implementation does nothing.</p>
<p><b>See also </b><a href="qtservicebase.html#pause">pause</a>() and QtServiceController::resume().</p>
<!-- @@@resume -->
<!-- $$$start[overload1]$$$start -->
<h3 class="fn" id="start"><a name="start"></a><code>[pure virtual protected] </code><span class="type">void</span> QtServiceBase::<span class="name">start</span>()</h3>
<p>This function must be implemented in <a href="qtservicebase.html">QtServiceBase</a> subclasses in order to perform the service's work. Usually you create some main object on the heap which is the heart of your service.</p>
<p>The function is only called when no service specific arguments were passed to the service constructor, and is called by exec() after it has called the <a href="qtservicebase.html#executeApplication">executeApplication</a>() function.</p>
<p>Note that you <i>don't</i> need to create an application object or call its exec() function explicitly.</p>
<p><b>See also </b>exec(), <a href="qtservicebase.html#stop">stop</a>(), and QtServiceController::start().</p>
<!-- @@@start -->
<!-- $$$stop[overload1]$$$stop -->
<h3 class="fn" id="stop"><a name="stop"></a><code>[virtual protected] </code><span class="type">void</span> QtServiceBase::<span class="name">stop</span>()</h3>
<p>Reimplement this function to perform additional cleanups before shutting down (for example deleting a main object if it was created in the <a href="qtservicebase.html#start">start</a>() function).</p>
<p>This function is called in reply to controller requests. The default implementation does nothing.</p>
<p><b>See also </b><a href="qtservicebase.html#start">start</a>() and QtServiceController::stop().</p>
<!-- @@@stop -->
</div>
</body>
</html>
